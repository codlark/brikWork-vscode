{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "brikWork",
    "scopeName": "source.brikWork",
    "patterns": [
        {
            "include": "#propOnly"
        },
        {
            "include": "#userBriks"
        },
        {
            "include": "#data"
        },
        {
            "include": "#section"
        },
        {
            "include": "#comments"
        }
    ],
    "repository": {
        "comments": {
            "match": "^\\s*#.*$",
            "name": "comment.line.number-sign.brikwork"
        },
        "propOnly": {
            "begin": "\\s*(layout|defaults)\\s*(\\{)",
            "beginCaptures": {
                "1": {
                    "name": "variable.language.brikwork"
                },
                "2": {
                    "name": "punctuation.section.begin.brikwork"
                }
            },
            "end": "(?<!\\\\)(\\})",
            "endCaptures": {
                "1": {
                    "name": "punctuation.section.end.brikwork"
                }
            },
            "patterns": [
                {
                    "include": "#comments"
                },
                {
                    "include": "#property"
                },
                {
                    "include": "#badEscape"
                }
            ]
        },
        "userBriks": {
            "begin": "\\s*(briks)\\s*(\\{)",
            "beginCaptures": {
                "1": {
                    "name": "variable.language.brikwork"
                },
                "2": {
                    "name": "punctuation.section.begin.brikwork"
                }
            },
            "end": "(?<!\\\\)(\\})",
            "endCaptures": {
                "1": {
                    "name": "punctuation.section.end.brikwork"
                }
            },
            "patterns": [
                {
                    "include": "#comments"
                },
                {
                    "include": "#brikDef"
                },
                {
                    "include": "#badEscape"
                }
            ]
        },
        "brikDef": {
            "begin": "\\s*([^=]+\\s*)(=)",
            "beginCaptures": {
                "1": {
                    "name": "variable.brik.brikwork"
                },
                "2": {
                    "name": "punctuation.definition.brikwork"
                }
            },
            "end": "(;)|\\n|(?=\\})",
            "endCaptures": {
                "1": {
                    "name": "punctuation.terminator.brikwork"
                }
            },
            "patterns": [
                {
                    "include": "#value"
                }
            ]
        },
        "data": {
            "begin": "\\s*(data)\\s*(\\{)",
            "beginCaptures": {
                "1": {
                    "name": "variable.language.brikwork"
                },
                "2": {
                    "name": "punctuation.section.begin.brikwork"
                }
            },
            "end": "(?<!\\\\)(\\})",
            "endCaptures": {
                "1": {
                    "name": "punctuation.section.end.brikwork"
                }
            },
            "patterns": [
                {
                    "include": "#comments"
                },
                {
                    "include": "#escape"
                },
                {
                    "match": ",",
                    "name": "punctuation.definition.data.brikwork"
                },
                {
                    "include": "#brik"
                }
            ]
        },
        "section": {
            "begin": "\\s*(\\S+)\\s*(\\{)",
            "beginCaptures": {
                "1": {
                    "name": "entity.name.section.brikwork"
                },
                "2": {
                    "name": "punctuation.section.begin.brikwork"
                }
            },
            "end": "(?<!\\\\)(\\})",
            "endCaptures": {
                "1": {
                    "name": "punctuation.section.end.brikwork"
                }
            },
            "patterns": [
                {
                    "include": "#comments"
                },
                {
                    "include": "#section"
                },
                {
                    "include": "#property"
                },
                {
                    "include": "#badEscape"
                }
            ]
        },
        "property": {
            "patterns": [
                {
                    "include": "#propertyType"
                },
                {
                    "include": "#propertyKnown"
                },
                {
                    "include": "#propertyBad"
                }
            ]
        },
        "propertyType": {
            "begin": "\\s*(type)(:)",
            "beginCaptures": {
                "1": {
                    "name": "entity.other.attribute-name.brikwork"
                },
                "2": {
                    "name": "punctuation.seperator.key_value.brikwork"
                }
            },
            "end": "(;)|\\n|(?=\\})",
            "endCaptures": {
                "1": {
                    "name": "punctuation.terminator.brikwork"
                }
            },
            "patterns": [
                {
                    "match": "\\s*none|label|image|rect|circ|ellipse|line\\s*",
                    "name": "storage.type.brikwork"
                }
            ]
        },
        "propertyKnown": {
            "begin": "(?x) \\s* (width|height|name|output|data|template| x|y|rotation|draw| text|fontFamily|fontSize|color|wordWrap|alignment|italic|bold|overline|underline|lineThrough| source|keepAspectRatio| lineColor|lineWidth|lineJoin|lineCap|fillColor| xRadius|yRadius| x2|y2)\\s*(:)\n",
            "beginCaptures": {
                "1": {
                    "name": "entity.other.attribute-name.brikwork"
                },
                "2": {
                    "name": "punctuation.seperator.key-value.brikwork"
                }
            },
            "end": "(;)|\\n|(?=\\})",
            "endCaptures": {
                "1": {
                    "name": "punctuation.terminator.brikwork"
                }
            },
            "patterns": [
                {
                    "include": "#value"
                }
            ]
        },
        "propertyBad": {
            "begin": "([^:]+)\\s*(:)",
            "beginCaptures": {
                "1": {
                    "name": "invalid.illegal.brikwork"
                },
                "2": {
                    "name": "punctuation.seperator.key-value.brikwork"
                }
            },
            "end": "(;)|\\n|(?=\\})",
            "endCaptures": {
                "1": {
                    "name": "punctuation.terminator.brikwork"
                }
            },
            "patterns": [
                {
                    "include": "#value"
                }
            ]
        },
        "value": {
            "patterns": [
                {
                    "include": "#escape"
                },
                {
                    "include": "#color"
                },
                {
                    "include": "#constant"
                },
                {
                    "include": "#number"
                },
                {
                    "include": "#toggle"
                },
                {
                    "include": "#brik"
                }
            ]
        },
        "escape": {
            "match": "\\\\\\S",
            "name": "constant.character.escape.brikwork"
        },
        "badEscape": {
            "match": "\\\\\\S",
            "name": "invalid.brikwork"
        },
        "constant": {
            "match": "(?x) center|left|right|justify| top|middle|bottom| miter|bevel|round| flat|square|round\n",
            "name": "support.constant.property-value.brikwork"
        },
        "number": {
            "match": "[-+]?[0-9]+(\\.[0-9]*)?\\s*(in)?",
            "name": "constant.numeric.brikwork"
        },
        "toggle": {
            "match": "true|yes|on|false|no|off",
            "name": "constant.language.brikwork"
        },
        "color": {
            "name": "constant.other.color.brikwork",
            "captures": {
                "1": {
                    "name": "constant.other.color.rgb-value.hex.brikwork"
                },
                "2": {
                    "name": "support.constant.color.svg-color-name.brikwork"
                }
            },
            "match": "(?x) (\\#[a-f0-9]{6})| (aliceblue|antiquewhite|aqua|aquamarine|azure|beige|bisque|black|blanchedalmond| blue|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk| crimson|cyan|darkblue|darkcyan|darkgoldenrod|darkgray|darkgrey|darkgreen|darkkhaki| darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen| darkslateblue|darkslategray|darkslategrey|darkturquoise|darkviolet|deeppink|deepskyblue| dimgray|dimgrey|dodgerblue|firebrik|floralwhite|forestgreen|fuchsia|gainsboro|ghostwhite| gold|goldenrod|gray|grey|green|greenyellow|honeydew|hotpink|indianred|indigo|ivory|khaki| lavender|lavenderblush|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan| lightgoldenrod|lightgray|lightgrey|lightgreen|lightpink|lightsalmon|lightseagreen| lightskyblue|lightslategray|lightslategrey|lightsteelblue|lightyellow|lime|limegreen| linen|megenta|maroon|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen| mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|mednightblue|mintcream| mistyrose|moccasin|navajowhite|navy|oldlace|olive|olivedrab|orange|orangered|orchid| palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum| powderblue|purple|red|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell| sienna|silver|skyblue|slateblue|slategray|slategrey|snow|springgreen|steelblue|tan|teal| thistle|tomato|turquoise|violet|wheat|white|whitesmoke|yellow|yellowgreen)\n"
        },
        "brik": {
            "patterns": [
                {
                    "include": "#ifBrik"
                },
                {
                    "include": "#testBrik"
                },
                {
                    "include": "#mathBrik"
                },
                {
                    "include": "#escapeBrik"
                },
                {
                    "include": "#brikBlank"
                },
                {
                    "include": "#brikStd"
                },
                {
                    "include": "#brikOther"
                }
            ]
        },
        "ifBrik": {
            "begin": "(\\[)\\s*(if)(?=[]|\\s])",
            "beginCaptures": {
                "1": {
                    "name": "punctuation.definition.string.begin.brikwork"
                },
                "2": {
                    "name": "keyword.control.if.brikwork"
                }
            },
            "end": "(?<!\\\\)\\]",
            "endCaptures": {
                "0": {
                    "name": "punctuation.definition.string.end.brikwork"
                }
            },
            "name": "string.interpolated.brikwork",
            "patterns": [
                {
                    "include": "#testOps"
                },
                {
                    "include": "#escape"
                },
                {
                    "match": "\\|",
                    "name": "punctuation.definition.string.continue.brikwork"
                },
                {
                    "include": "#brik"
                },
                {
                    "match": "\\?",
                    "name": "keyword.operator.brikwork"
                }
            ]
        },
        "testBrik": {
            "begin": "(\\[)\\s*(\\?)(?=[]|\\s])",
            "beginCaptures": {
                "1": {
                    "name": "punctuation.definition.string.begin.brikwork"
                },
                "2": {
                    "name": "control.keyword.brikwork"
                }
            },
            "end": "(?<!\\\\)\\]",
            "endCaptures": {
                "0": {
                    "name": "punctuation.definition.string.end.brikwork"
                }
            },
            "name": "string.interpolated.brikwork",
            "patterns": [
                {
                    "include": "#testOps"
                },
                {
                    "include": "#escape"
                },
                {
                    "match": "\\|",
                    "name": "punctuation.definition.string.continue.brikwork"
                },
                {
                    "include": "#brik"
                }
            ]
        },
        "testOps": {
            "match": "==|=!|>|>=|<|<=",
            "name": "keyword.operator.brikwork"
        },
        "mathBrik": {
            "begin": "(\\[)\\s*(#)(?=[]|\\s])",
            "beginCaptures": {
                "1": {
                    "name": "punctuation.definition.string.begin.brikwork"
                },
                "2": {
                    "name": "keyword.control.brikwork"
                }
            },
            "end": "(?<!\\\\)\\]",
            "endCaptures": {
                "0": {
                    "name": "punctuation.definition.string.end.brikwork"
                }
            },
            "name": "string.interpolated.brikwork",
            "patterns": [
                {
                    "match": "\\+|-|\\*|/|%",
                    "name": "keyword.operator.brikwork"
                },
                {
                    "include": "#escape"
                },
                {
                    "match": "\\|",
                    "name": "punctuation.definition.string.continue.brikwork"
                },
                {
                    "include": "#brik"
                }
            ]
        },
        "escapeBrik": {
            "begin": "(\\[)\\s*(/)(?=[]|\\s])",
            "beginCaptures": {
                "1": {
                    "name": "punctuation.definition.string.begin.brikwork"
                },
                "2": {
                    "name": "control.keyword.brikwork"
                }
            },
            "end": "(?<!\\\\)\\]",
            "endCaptures": {
                "0": {
                    "name": "punctuation.definition.string.end.brikwork"
                }
            },
            "name": "string.interpolated.brikwork",
            "patterns": [
                {
                    "match": "\\\\\\S",
                    "name": "constant.character.placeholder.brikwork"
                },
                {
                    "include": "#escape"
                },
                {
                    "match": "\\|",
                    "name": "punctuation.definition.string.continue.brikwork"
                },
                {
                    "include": "#brik"
                }
            ]
        },
        "brikBlank": {
            "match": "\\[\\s*\\]",
            "name": "constant.language.brikwork"
        },
        "brikStd": {
            "begin": "(?x) (\\[)\\s* (rowIndex|rowTotal|assetIndex|assetTotal|repeatIndex|repeatTotal| b|i|u|s| capitalize|lower|upper| dup|file|substring| in|eq|ne )(?=[]|\\s])\n",
            "beginCaptures": {
                "1": {
                    "name": "punctuation.definition.string.begin.brikwork"
                },
                "2": {
                    "name": "variable.function.brikwork"
                }
            },
            "end": "(?<!\\\\)\\]",
            "endCaptures": {
                "0": {
                    "name": "punctuation.definition.string.end.brikwork"
                }
            },
            "name": "string.interpolated.brikwork",
            "patterns": [
                {
                    "include": "#escape"
                },
                {
                    "match": "\\|",
                    "name": "punctuation.definition.string.continue.brikwork"
                },
                {
                    "include": "#brik"
                }
            ]
        },
        "brikOther": {
            "begin": "(\\[)\\s*([^]|]*?)(?=[]|\\s])",
            "beginCaptures": {
                "1": {
                    "name": "punctuation.definition.string.begin.brikwork"
                },
                "2": {
                    "name": "variable.other.brikwork"
                }
            },
            "end": "(?<!\\\\)\\]",
            "endCaptures": {
                "0": {
                    "name": "punctuation.definition.string.end.brikwork"
                }
            },
            "name": "string.interpolated.brikwork",
            "patterns": [
                {
                    "include": "#escape"
                },
                {
                    "match": "\\|",
                    "name": "punctuation.definition.string.continue.brikwork"
                },
                {
                    "include": "#brik"
                }
            ]
        }
    }
}